<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Utility Functions" href="utility_functions.html" /><link rel="prev" title="Creating Node Classes" href="creating_node_classes.html" />

    <link rel="shortcut icon" href="_static/ros_bt_py.ico"/><!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>Testing Node Classes - ros_bt_py 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">ros_bt_py 0.0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/ros_bt_py_128.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">ros_bt_py 0.0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_node_classes.html">Creating Node Classes</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Testing Node Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility_functions.html">Utility Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="testing-node-classes">
<span id="testing-nodes"></span><h1>Testing Node Classes<a class="headerlink" href="#testing-node-classes" title="Link to this heading">#</a></h1>
<p>Even though a lot of errors are harder to make and/or easier to catch
with <code class="xref py py-mod docutils literal notranslate"><span class="pre">ros_bt_py</span></code> than with other libraries, you should still
test any new node classes you make.</p>
<p>The easiest way to to this is by adding tests to your ROS2 package.  To
do that, you simply create a new folder, slap some test scripts in
there, and add a few lines to your <code class="code docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> or <code class="code docutils literal notranslate"><span class="pre">setup.py</span></code>, and
<code class="code docutils literal notranslate"><span class="pre">package.xml</span></code>.  I’ll walk you through it:</p>
<section id="creating-a-test-folder-and-unit-test-script">
<h2>Creating a Test Folder and Unit Test Script<a class="headerlink" href="#creating-a-test-folder-and-unit-test-script" title="Link to this heading">#</a></h2>
<p>The most common way to write Python unit tests in ROS2 is the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">pytest</span></code> module.</p>
<p>So, within your ROS package, create a new folder called
<code class="code docutils literal notranslate"><span class="pre">tests/</span></code>.
Next, create a new file called <code class="code docutils literal notranslate"><span class="pre">test_my_node.py</span></code> and put the
following code in it</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">pytest</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1"># Useful to have the state names to compare against</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">ros_bt_py_interfaces.msg</span> <span class="kn">import</span> <span class="n">Node</span> <span class="k">as</span> <span class="n">NodeMsg</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="kn">from</span> <span class="nn">my_pacakge.nodes.my_awesome_node</span> <span class="kn">import</span> <span class="n">MyAwesomeNode</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="k">def</span> <span class="nf">test_setup</span><span class="p">():</span>
<span class="linenos"> 9</span>  <span class="n">awesome</span> <span class="o">=</span> <span class="n">MyAwesomeNode</span><span class="p">()</span>
<span class="linenos">10</span>  <span class="n">awesome</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
<span class="linenos">11</span>
<span class="linenos">12</span>  <span class="c1"># Any node should be IDLE after calling setup()</span>
<span class="linenos">13</span>  <span class="k">assert</span> <span class="n">awesome</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">NodeMsg</span><span class="o">.</span><span class="n">IDLE</span>
</pre></div>
</div>
<p>A lot of the names here are important, because pytest uses the function name to find
and run tests.  Your test script must start with the word “test”.</p>
</section>
<section id="running-your-unit-tests">
<h2>Running your Unit Tests<a class="headerlink" href="#running-your-unit-tests" title="Link to this heading">#</a></h2>
<p>Now, to actually <em>run</em> your unit tests, simply go to the package folder and run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest
</pre></div>
</div>
</section>
<section id="adding-your-unit-tests-to-cmakelists-txt">
<h2>Adding your Unit Tests to CMakeLists.txt<a class="headerlink" href="#adding-your-unit-tests-to-cmakelists-txt" title="Link to this heading">#</a></h2>
<p>If you want your tests to be run by the CI pipeline (and who
doesn’t?) and you use CMakeLists.txt to build your package,
you’ll also have to tell the build system about them.</p>
<p>More info can be found in the ROS2 <a class="reference external" href="https://docs.ros.org/en/rolling/How-To-Guides/Ament-CMake-Python-Documentation.html">tutorials</a> .</p>
<p>Don’t worry, it’s easy - just add the following lines to your
<cite>CMakeLists.txt</cite>, and nose will do the rest</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nb">if</span><span class="w"> </span><span class="p">(</span><span class="s">BUILD_TESTING</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="w">  </span><span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake_pytest</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="w">  </span><span class="c"># Add the python test files you wrote here:</span>
<span class="linenos"> 5</span><span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="s">_pytest_tests</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="s">tests/test_a.py</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="s">tests/test_b.py</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="c"># Add other test files here</span>
<span class="linenos"> 9</span><span class="w">  </span><span class="p">)</span>
<span class="linenos">10</span><span class="w">  </span><span class="nb">foreach</span><span class="p">(</span><span class="s">_test_path</span><span class="w"> </span><span class="o">${</span><span class="nv">_pytest_tests</span><span class="o">}</span><span class="p">)</span>
<span class="linenos">11</span><span class="w">    </span><span class="nb">get_filename_component</span><span class="p">(</span><span class="s">_test_name</span><span class="w"> </span><span class="o">${</span><span class="nv">_test_path</span><span class="o">}</span><span class="w"> </span><span class="s">NAME_WE</span><span class="p">)</span>
<span class="linenos">12</span><span class="w">    </span><span class="nb">ament_add_pytest_test</span><span class="p">(</span><span class="o">${</span><span class="nv">_test_name</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">_test_path</span><span class="o">}</span>
<span class="linenos">13</span><span class="w">      </span><span class="s">APPEND_ENV</span><span class="w"> </span><span class="s">PYTHONPATH=</span><span class="o">${</span><span class="nv">CMAKE_CURRENT_BINARY_DIR</span><span class="o">}</span>
<span class="linenos">14</span><span class="w">      </span><span class="s">TIMEOUT</span><span class="w"> </span><span class="s">60</span>
<span class="linenos">15</span><span class="w">      </span><span class="s">WORKING_DIRECTORY</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_SOURCE_DIR</span><span class="o">}</span>
<span class="linenos">16</span><span class="w">    </span><span class="p">)</span>
<span class="linenos">17</span><span class="w">  </span><span class="nb">endforeach</span><span class="p">()</span>
<span class="linenos">18</span><span class="nb">endif</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="adding-your-unit-tests-to-setup-py">
<h2>Adding your Unit Tests to setup.py<a class="headerlink" href="#adding-your-unit-tests-to-setup-py" title="Link to this heading">#</a></h2>
<p>When using an <code class="docutils literal notranslate"><span class="pre">ament_python</span></code> package, pytest based tests are automatically picked up by the system.
No additional steps should be required.</p>
</section>
<section id="running-tests-via-colcon">
<h2>Running Tests via colcon<a class="headerlink" href="#running-tests-via-colcon" title="Link to this heading">#</a></h2>
<p>Now that you’ve registered your tests with ROS2 and colcon, you can use colcon
to run them</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>colcon<span class="w"> </span><span class="nb">test</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="utility_functions.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Utility Functions</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="creating_node_classes.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Creating Node Classes</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, FZI Forschungszentrum Informatik
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Testing Node Classes</a><ul>
<li><a class="reference internal" href="#creating-a-test-folder-and-unit-test-script">Creating a Test Folder and Unit Test Script</a></li>
<li><a class="reference internal" href="#running-your-unit-tests">Running your Unit Tests</a></li>
<li><a class="reference internal" href="#adding-your-unit-tests-to-cmakelists-txt">Adding your Unit Tests to CMakeLists.txt</a></li>
<li><a class="reference internal" href="#adding-your-unit-tests-to-setup-py">Adding your Unit Tests to setup.py</a></li>
<li><a class="reference internal" href="#running-tests-via-colcon">Running Tests via colcon</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=d45e8c67"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>